import fs from "node:fs";
import path from "node:path";

const ROOT = process.cwd();

const FILES = [
  "llms.txt",
  "README.md",
  "package.json",
  "bin/cli.js",
  "vite.config.ts",
  "CHANGELOG.md",
  "CONTRIBUTING.md",
  "SECURITY.md",
  "ACKNOWLEDMENTS.md",
  "LICENSE",
  "docs/README.md",
  "docs/getting-started.md",
  "docs/faq.md",
  "docs/architecture.md",
  "docs/api.md",
  "docs/configuration.md",
  "docs/development.md",
  "docs/security.md",
  "docs/troubleshooting.md",
];

const header =
  "# AbstractObserver — llms-full\n\n" +
  "> Expanded context for LLM agents: `llms.txt` + core docs + selected config/entrypoint files. Source of truth remains the code.\n\n" +
  "Generated by `scripts/generate-llms-full.mjs` — do not edit by hand.\n\n" +
  "How to use:\n" +
  "- Start with `llms.txt` for a concise map.\n" +
  "- Search within this file for `## <path>` sections to jump to details.\n" +
  "- After doc/code changes, regenerate with `npm run llms:full`.\n" +
  "\n" +
  "This file intentionally embeds docs and small, high-signal project files. For large source files, follow links in `llms.txt`.\n";

function readUtf8(p) {
  return fs.readFileSync(path.resolve(ROOT, p), "utf8").trimEnd();
}

function main() {
  const chunks = [header];

  for (const p of FILES) {
    chunks.push(`\n\n## ${p}\n\n`);
    chunks.push(readUtf8(p));
    chunks.push("\n\n---\n");
  }

  const out = chunks.join("").trimEnd() + "\n";
  fs.writeFileSync(path.resolve(ROOT, "llms-full.txt"), out, "utf8");
}

main();
